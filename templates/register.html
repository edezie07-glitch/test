<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HPZ Messenger — Register</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=Manrope:wght@400;500;600&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box;}
:root{--brand:#7c6aff;--brand-dk:#6254e0;--font-h:'Syne',sans-serif;--font-b:'Manrope',sans-serif;}
html,body{height:100%;overflow:hidden;}
body{
  font-family:var(--font-b);
  background:#0f0f17;
  display:flex;align-items:center;justify-content:center;
  min-height:100vh;position:relative;
}
body::before{
  content:'';position:fixed;top:-30%;left:-20%;
  width:600px;height:600px;
  background:radial-gradient(circle,rgba(124,106,255,.18) 0%,transparent 70%);
  animation:float1 8s ease-in-out infinite;pointer-events:none;
}
body::after{
  content:'';position:fixed;bottom:-20%;right:-15%;
  width:500px;height:500px;
  background:radial-gradient(circle,rgba(99,84,224,.14) 0%,transparent 70%);
  animation:float2 10s ease-in-out infinite;pointer-events:none;
}
@keyframes float1{0%,100%{transform:translate(0,0);}50%{transform:translate(40px,-40px);}}
@keyframes float2{0%,100%{transform:translate(0,0);}50%{transform:translate(-30px,30px);}}

.card{
  background:rgba(22,22,31,.85);
  border:1px solid rgba(255,255,255,.08);
  border-radius:24px;
  padding:44px 40px 40px;
  width:100%;max-width:400px;
  backdrop-filter:blur(20px);
  box-shadow:0 24px 80px rgba(0,0,0,.5);
  position:relative;z-index:1;
  animation:slideUp .45s cubic-bezier(.4,0,.2,1);
}
@keyframes slideUp{from{opacity:0;transform:translateY(28px);}to{opacity:1;transform:translateY(0);}}

.logo-wrap{display:flex;align-items:center;justify-content:center;gap:12px;margin-bottom:28px;}
.logo-img{
  width:52px;height:52px;border-radius:14px;
  object-fit:cover;
  box-shadow:0 0 0 2px rgba(124,106,255,.3),0 8px 24px rgba(124,106,255,.25);
}
.logo-text{
  font-family:var(--font-h);font-size:26px;font-weight:800;
  color:#fff;letter-spacing:-.5px;
}
h1{font-family:var(--font-h);font-size:22px;font-weight:700;color:#e8e8f4;text-align:center;margin-bottom:6px;}
.sub{font-size:13.5px;color:rgba(255,255,255,.4);text-align:center;margin-bottom:28px;}

.field{display:flex;flex-direction:column;gap:5px;margin-bottom:14px;}
.field label{font-size:11.5px;font-weight:600;color:rgba(255,255,255,.4);text-transform:uppercase;letter-spacing:.07em;}
.field input{
  padding:11px 14px;
  background:rgba(255,255,255,.05);
  border:1px solid rgba(255,255,255,.1);
  border-radius:11px;
  color:#e8e8f4;font-size:14px;font-family:var(--font-b);
  transition:border-color .18s,background .18s;outline:none;
}
.field input:focus{border-color:var(--brand);background:rgba(124,106,255,.08);}
.field input::placeholder{color:rgba(255,255,255,.2);}

.hint{font-size:11px;color:rgba(255,255,255,.25);margin-top:3px;}

.btn{
  width:100%;padding:13px;margin-top:6px;
  background:var(--brand);color:#fff;
  border:none;border-radius:12px;
  font-size:14.5px;font-weight:700;font-family:var(--font-b);
  cursor:pointer;
  transition:background .18s,transform .12s,box-shadow .18s;
  box-shadow:0 4px 20px rgba(124,106,255,.35);
}
.btn:hover{background:var(--brand-dk);box-shadow:0 6px 28px rgba(124,106,255,.45);}
.btn:active{transform:scale(.97);}
.btn:disabled{opacity:.55;cursor:not-allowed;transform:none;}

.err{background:rgba(239,68,68,.1);border:1px solid rgba(239,68,68,.25);color:#f87171;font-size:13px;padding:9px 13px;border-radius:9px;margin-bottom:12px;display:none;}
.err.show{display:block;}

.divider{display:flex;align-items:center;gap:10px;color:rgba(255,255,255,.2);font-size:12px;margin:18px 0;}
.divider::before,.divider::after{content:'';flex:1;height:1px;background:rgba(255,255,255,.08);}
.link-row{text-align:center;font-size:13.5px;color:rgba(255,255,255,.4);}
.link-row a{color:var(--brand);text-decoration:none;font-weight:600;}
.link-row a:hover{text-decoration:underline;}
</style>
</head>
<body>
<div class="card">
  <div class="logo-wrap">
    <img class="logo-img" src="/logo" alt="HPZ Logo" onerror="this.style.display='none'">
    <span class="logo-text">HPZ</span>
  </div>
  <h1>Create account</h1>
  <p class="sub">Join HPZ Messenger today</p>

  <div class="err" id="err"></div>

  <div class="field">
    <label>Username</label>
    <input type="text" id="username" placeholder="Choose a username" autocomplete="username">
    <span class="hint">Minimum 3 characters</span>
  </div>
  <div class="field">
    <label>Password</label>
    <input type="password" id="password" placeholder="Create a password" autocomplete="new-password">
    <span class="hint">Minimum 6 characters</span>
  </div>
  <div class="field">
    <label>Confirm Password</label>
    <input type="password" id="confirm" placeholder="Repeat your password" autocomplete="new-password"
      onkeydown="if(event.key==='Enter')doRegister()">
  </div>

  <button class="btn" id="regBtn" onclick="doRegister()">Create Account</button>

  <div class="divider">or</div>
  <div class="link-row">Already have an account? <a href="/">Sign in</a></div>
</div>

<script>
async function doRegister(){
  const un=document.getElementById('username').value.trim();
  const pw=document.getElementById('password').value;
  const cf=document.getElementById('confirm').value;
  const btn=document.getElementById('regBtn');
  const err=document.getElementById('err');
  err.classList.remove('show');
  if(!un||!pw||!cf){showErr('Please fill in all fields.');return;}
  if(un.length<3){showErr('Username must be at least 3 characters.');return;}
  if(pw.length<6){showErr('Password must be at least 6 characters.');return;}
  if(pw!==cf){showErr('Passwords do not match.');return;}
  btn.disabled=true;btn.textContent='Creating account…';
  try{
    const r=await fetch('/api/auth/register',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username:un,password:pw})});
    const d=await r.json();
    if(d.success){window.location.href=d.redirect||'/chat';}
    else{showErr(d.error||'Registration failed.');}
  }catch(e){showErr('Connection error. Try again.');}
  btn.disabled=false;btn.textContent='Create Account';
}
function showErr(msg){const e=document.getElementById('err');e.textContent=msg;e.classList.add('show');}
</script>
</body>
</html>
